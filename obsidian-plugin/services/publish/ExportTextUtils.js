import MarkdownIt from 'markdown-it';
const md = new MarkdownIt({ html: false, linkify: false, typographer: false });
function decodeEntities(s) {
    // Minimal decode for common entities produced by markdown-it.
    return s
        .replace(/&nbsp;/g, ' ')
        .replace(/&amp;/g, '&')
        .replace(/&lt;/g, '<')
        .replace(/&gt;/g, '>')
        .replace(/&quot;/g, '"')
        .replace(/&#39;/g, "'");
}
export function markdownToPlainText(markdown) {
    const html = md.render(markdown || '');
    // Strip tags and collapse whitespace. Keep paragraph breaks.
    const withBreaks = html
        .replace(/<\/p>\s*<p>/g, '\n\n')
        .replace(/<br\s*\/?>/g, '\n')
        .replace(/<\/h\d>\s*<h\d[^>]*>/g, '\n\n')
        .replace(/<\/li>\s*<li>/g, '\n')
        .replace(/<\/(ul|ol)>/g, '\n\n');
    const stripped = withBreaks.replace(/<[^>]+>/g, '');
    return decodeEntities(stripped).replace(/\n{3,}/g, '\n\n').trim();
}
export function sliceFirstNWords(text, wordLimit) {
    const limit = Math.max(0, Math.floor(wordLimit));
    if (limit <= 0)
        return '';
    const words = (text || '').trim().split(/\s+/g).filter(Boolean);
    if (words.length <= limit)
        return words.join(' ');
    return words.slice(0, limit).join(' ');
}
export function countWords(text) {
    return (text || '').trim().split(/\s+/g).filter(Boolean).length;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRXhwb3J0VGV4dFV0aWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiRXhwb3J0VGV4dFV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sVUFBVSxNQUFNLGFBQWEsQ0FBQztBQUVyQyxNQUFNLEVBQUUsR0FBRyxJQUFJLFVBQVUsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztBQUUvRSxTQUFTLGNBQWMsQ0FBQyxDQUFTO0lBQ2hDLDhEQUE4RDtJQUM5RCxPQUFPLENBQUM7U0FDTixPQUFPLENBQUMsU0FBUyxFQUFFLEdBQUcsQ0FBQztTQUN2QixPQUFPLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQztTQUN0QixPQUFPLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQztTQUNyQixPQUFPLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQztTQUNyQixPQUFPLENBQUMsU0FBUyxFQUFFLEdBQUcsQ0FBQztTQUN2QixPQUFPLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0FBQzFCLENBQUM7QUFFRCxNQUFNLFVBQVUsbUJBQW1CLENBQUMsUUFBZ0I7SUFDbkQsTUFBTSxJQUFJLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDLENBQUM7SUFDdkMsNkRBQTZEO0lBQzdELE1BQU0sVUFBVSxHQUFHLElBQUk7U0FDckIsT0FBTyxDQUFDLGNBQWMsRUFBRSxNQUFNLENBQUM7U0FDL0IsT0FBTyxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUM7U0FDNUIsT0FBTyxDQUFDLHVCQUF1QixFQUFFLE1BQU0sQ0FBQztTQUN4QyxPQUFPLENBQUMsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDO1NBQy9CLE9BQU8sQ0FBQyxjQUFjLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDbEMsTUFBTSxRQUFRLEdBQUcsVUFBVSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDcEQsT0FBTyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNuRSxDQUFDO0FBRUQsTUFBTSxVQUFVLGdCQUFnQixDQUFDLElBQVksRUFBRSxTQUFpQjtJQUMvRCxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7SUFDakQsSUFBSSxLQUFLLElBQUksQ0FBQztRQUFFLE9BQU8sRUFBRSxDQUFDO0lBQzFCLE1BQU0sS0FBSyxHQUFHLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDaEUsSUFBSSxLQUFLLENBQUMsTUFBTSxJQUFJLEtBQUs7UUFBRSxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDbEQsT0FBTyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDeEMsQ0FBQztBQUVELE1BQU0sVUFBVSxVQUFVLENBQUMsSUFBWTtJQUN0QyxPQUFPLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ2pFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTWFya2Rvd25JdCBmcm9tICdtYXJrZG93bi1pdCc7XG5cbmNvbnN0IG1kID0gbmV3IE1hcmtkb3duSXQoeyBodG1sOiBmYWxzZSwgbGlua2lmeTogZmFsc2UsIHR5cG9ncmFwaGVyOiBmYWxzZSB9KTtcblxuZnVuY3Rpb24gZGVjb2RlRW50aXRpZXMoczogc3RyaW5nKTogc3RyaW5nIHtcblx0Ly8gTWluaW1hbCBkZWNvZGUgZm9yIGNvbW1vbiBlbnRpdGllcyBwcm9kdWNlZCBieSBtYXJrZG93bi1pdC5cblx0cmV0dXJuIHNcblx0XHQucmVwbGFjZSgvJm5ic3A7L2csICcgJylcblx0XHQucmVwbGFjZSgvJmFtcDsvZywgJyYnKVxuXHRcdC5yZXBsYWNlKC8mbHQ7L2csICc8Jylcblx0XHQucmVwbGFjZSgvJmd0Oy9nLCAnPicpXG5cdFx0LnJlcGxhY2UoLyZxdW90Oy9nLCAnXCInKVxuXHRcdC5yZXBsYWNlKC8mIzM5Oy9nLCBcIidcIik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXJrZG93blRvUGxhaW5UZXh0KG1hcmtkb3duOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRjb25zdCBodG1sID0gbWQucmVuZGVyKG1hcmtkb3duIHx8ICcnKTtcblx0Ly8gU3RyaXAgdGFncyBhbmQgY29sbGFwc2Ugd2hpdGVzcGFjZS4gS2VlcCBwYXJhZ3JhcGggYnJlYWtzLlxuXHRjb25zdCB3aXRoQnJlYWtzID0gaHRtbFxuXHRcdC5yZXBsYWNlKC88XFwvcD5cXHMqPHA+L2csICdcXG5cXG4nKVxuXHRcdC5yZXBsYWNlKC88YnJcXHMqXFwvPz4vZywgJ1xcbicpXG5cdFx0LnJlcGxhY2UoLzxcXC9oXFxkPlxccyo8aFxcZFtePl0qPi9nLCAnXFxuXFxuJylcblx0XHQucmVwbGFjZSgvPFxcL2xpPlxccyo8bGk+L2csICdcXG4nKVxuXHRcdC5yZXBsYWNlKC88XFwvKHVsfG9sKT4vZywgJ1xcblxcbicpO1xuXHRjb25zdCBzdHJpcHBlZCA9IHdpdGhCcmVha3MucmVwbGFjZSgvPFtePl0rPi9nLCAnJyk7XG5cdHJldHVybiBkZWNvZGVFbnRpdGllcyhzdHJpcHBlZCkucmVwbGFjZSgvXFxuezMsfS9nLCAnXFxuXFxuJykudHJpbSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2xpY2VGaXJzdE5Xb3Jkcyh0ZXh0OiBzdHJpbmcsIHdvcmRMaW1pdDogbnVtYmVyKTogc3RyaW5nIHtcblx0Y29uc3QgbGltaXQgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHdvcmRMaW1pdCkpO1xuXHRpZiAobGltaXQgPD0gMCkgcmV0dXJuICcnO1xuXHRjb25zdCB3b3JkcyA9ICh0ZXh0IHx8ICcnKS50cmltKCkuc3BsaXQoL1xccysvZykuZmlsdGVyKEJvb2xlYW4pO1xuXHRpZiAod29yZHMubGVuZ3RoIDw9IGxpbWl0KSByZXR1cm4gd29yZHMuam9pbignICcpO1xuXHRyZXR1cm4gd29yZHMuc2xpY2UoMCwgbGltaXQpLmpvaW4oJyAnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvdW50V29yZHModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcblx0cmV0dXJuICh0ZXh0IHx8ICcnKS50cmltKCkuc3BsaXQoL1xccysvZykuZmlsdGVyKEJvb2xlYW4pLmxlbmd0aDtcbn1cblxuXG4iXX0=